{% extends 'base.html' %}

{% block content %}
    <div class="container py-4">
        <div class="p-5 mb-4 bg-body-tertiary rounded-3">
            <h1 class="display-5 fw-bold">{{ object.title }}</h1>
            <p class="fs-4">{{ object.description }}</p>
        </div>
        <form method="post">
            {% csrf_token %}
            {% for survey_question in survey_questions %}
                {% include 'survey/components/question.html' %}
            {% endfor %}

            <button type="submit" class="btn btn-primary mt-5">제출하기</button>
        </form>
    </div>
    <script>
        const handleOtherChange = (element) => {
            const otherTextDiv = document.getElementById('other_text_div_' + element.id.split('_')[1]);
            if (element.checked) {
                otherTextDiv.style.display = "block";  // 텍스트 입력 필드를 표시
            } else {
                otherTextDiv.style.display = "none";   // 텍스트 입력 필드를 숨김
                otherTextDiv.querySelector('input').value = ''; // 체크 해제 시 입력 필드 초기화
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('input[data-is-other="true"]').forEach((otherSelection) => {
                if (otherSelection.type === "radio") {
                    document.querySelectorAll(`input[type="radio"][name="${otherSelection.name}"]:not([data-is-other])`)
                        .forEach((selection) => {
                            selection.addEventListener('change', () => {
                                handleOtherChange(otherSelection);
                            })
                        })
                }

                otherSelection.addEventListener('change', () => {
                    handleOtherChange(otherSelection)
                })
            })
        });
    </script>
{% endblock content %}